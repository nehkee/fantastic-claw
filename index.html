<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fantastic Claw</title>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#0f172a;
  --panel:#111827;
  --panel-light:#1f2937;
  --accent:#6366f1;
  --accent-glow: rgba(99, 102, 241, 0.3);
  --success:#22c55e;
  --warning:#f59e0b;
  --danger:#ef4444;
  --text:#e5e7eb;
  --muted:#9ca3af;
  --border: rgba(255, 255, 255, 0.08);
}

*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:'Inter',sans-serif;
  background:linear-gradient(145deg,#0f172a,#111827);
  color:var(--text);
  min-height: 100vh;
}

/* NAVIGATION */
nav {
  display: flex; justify-content: space-between; align-items: center;
  padding: 20px 8%; background: rgba(15, 23, 42, 0.8);
  backdrop-filter: blur(12px); border-bottom: 1px solid var(--border);
  position: sticky; top: 0; z-index: 1000;
}
.brand { font-weight: 700; font-size: 20px; color: #fff; letter-spacing: -1px; }
.nav-links { display: flex; gap: 20px; }
.nav-link { 
  color: var(--muted); text-decoration: none; font-size: 14px; 
  font-weight: 600; cursor: pointer; transition: 0.3s; 
  padding: 8px 16px; border-radius: 8px;
}
.nav-link.active { color: #fff; background: var(--panel-light); }

/* HERO */
.hero{ text-align:center; padding:60px 20px 20px; }
.hero h1{ font-size:44px; font-weight:700; }
.hero p{ margin-top:15px; color:var(--muted); font-size:18px; }

/* INPUT SECTION */
.search-box{
  max-width:800px; margin:30px auto; background:var(--panel);
  padding:24px; border-radius:16px; border:1px solid var(--border);
  box-shadow: 0 20px 50px rgba(0,0,0,0.3);
}

.mode-toggle{
  display:flex; justify-content:center; margin-bottom:20px;
  background: #0b1220; padding: 5px; border-radius: 12px;
  width: fit-content; margin: 0 auto 20px auto;
}
.mode-toggle button{
  padding:10px 24px; border:none; background:transparent;
  color:var(--muted); cursor:pointer; border-radius: 10px;
  font-weight: 600; transition: 0.3s;
}
.mode-toggle button.active{
  background:var(--accent); color:white;
  box-shadow: 0 4px 12px var(--accent-glow);
}

.input-group{ display:flex; gap:12px; }
input{
  flex:1; padding:14px 18px; border-radius:12px;
  border:1px solid var(--panel-light); background:#0b1220;
  color:var(--text); font-size: 16px; outline: none;
}
input:focus { border-color: var(--accent); }
button.primary{
  background:var(--accent); border:none; padding:12px 28px;
  border-radius:12px; color:white; font-weight:700;
  cursor:pointer; transition: 0.3s;
}
button.primary:hover { transform: translateY(-2px); box-shadow: 0 8px 20px var(--accent-glow); }
button.primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; box-shadow: none; }

/* DYNAMIC AI DASHBOARD */
.dashboard{
  display:none; padding:20px; max-width:1000px; margin:0 auto 60px;
}
.ai-report {
  background: var(--panel); padding: 40px; border-radius: 20px;
  border: 1px solid var(--border); box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  line-height: 1.7; font-size: 15px;
}

/* MARKDOWN STYLING FOR AI REPORT */
.ai-report h2 { color: var(--accent); margin: 30px 0 15px; border-bottom: 1px solid var(--panel-light); padding-bottom: 10px; font-size: 22px; }
.ai-report h2:first-child { margin-top: 0; }
.ai-report h3 { color: #fff; margin: 20px 0 10px; font-size: 18px; }
.ai-report p { margin-bottom: 15px; color: var(--text); }
.ai-report strong { color: #fff; }
.ai-report ul { margin-left: 20px; margin-bottom: 15px; color: var(--muted); }
.ai-report li { margin-bottom: 8px; }
.ai-report a { 
  color: var(--accent); text-decoration: none; font-weight: 600; 
  background: rgba(99, 102, 241, 0.1); padding: 2px 6px; border-radius: 4px;
}
.ai-report a:hover { background: var(--accent); color: #fff; }
.ai-report table { width: 100%; border-collapse: collapse; margin: 20px 0; background: var(--panel-light); border-radius: 8px; overflow: hidden; }
.ai-report th, .ai-report td { padding: 14px; border: 1px solid var(--border); text-align: left; }
.ai-report th { background: #0b1220; color: var(--muted); text-transform: uppercase; font-size: 12px; letter-spacing: 1px; }

/* DOCS SECTION */
.docs-section { display: none; max-width: 900px; margin: 60px auto; padding: 0 20px; }
.docs-content h2 { color: var(--accent); margin: 40px 0 20px; font-size: 24px; }
.docs-content p { color: var(--muted); line-height: 1.8; margin-bottom: 20px; }

/* PAGES */
.page { display: none; animation: fadeIn 0.4s ease-out; }
.page.active { display: block; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>

<body>

<nav>
  <div class="brand">Fantastic Claw</div>
  <div class="nav-links">
    <div class="nav-link active" onclick="showPage('terminal')" id="link-terminal">Terminal</div>
    <div class="nav-link" onclick="showPage('docs')" id="link-docs">Protocol Docs</div>
  </div>
</nav>

<main id="terminal-page" class="page active">
  <section class="hero">
    <h1>Find Better Deals. Flip Smarter.</h1>
    <p>AI-powered arbitrage intelligence for shoppers and resellers.</p>
  </section>

  <div class="search-box">
    <div class="mode-toggle">
      <button id="buyerMode" class="active">üõí Buyer</button>
      <button id="resellerMode">üì¶ Reseller</button>
    </div>

    <div class="input-group">
      <input id="productInput" placeholder="Paste product URL or type product name..." autocomplete="off" />
      <button class="primary" onclick="analyze()">Analyze</button>
    </div>
  </div>

  <section class="dashboard" id="dashboard">
    <div class="ai-report" id="dashboard-content">
      </div>
  </section>
</main>

<main id="docs-page" class="page">
  <div class="docs-section" style="display: block;">
    <div class="docs-content">
      <h1>Fantastic Claw</h1>
      <p>Fantastic operates on the <strong>Claw Protocol</strong>, an agentic framework designed to bypass retail data obfuscation and provide high-fidelity financial insights.</p>
      
      <h2>Operational Modes</h2>
      <p><strong>Buyer Mode:</strong> Optimized for consumer savings. Retrieves Product Descriptions, Ratings, Price History, and the Best Alternative Deals via clickable links.</p>
      <p><strong>Reseller Mode:</strong> Optimized for Arbitrage. Executes all Buyer functions, but adds a Valuation calculation to reveal true Net Profit and ROI based on generic marketplace fees.</p>
    </div>
  </div>
</main>

<script>
let mode = "buyer";

// Navigation Logic
function showPage(pageId) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
  
  if(pageId === 'terminal') {
    document.getElementById('terminal-page').classList.add('active');
    document.getElementById('link-terminal').classList.add('active');
  } else {
    document.getElementById('docs-page').classList.add('active');
    document.getElementById('link-docs').classList.add('active');
  }
}

// Mode Toggle Logic
document.getElementById("buyerMode").onclick = () => {
  mode = "buyer";
  document.getElementById("buyerMode").classList.add("active");
  document.getElementById("resellerMode").classList.remove("active");
};

document.getElementById("resellerMode").onclick = () => {
  mode = "reseller";
  document.getElementById("resellerMode").classList.add("active");
  document.getElementById("buyerMode").classList.remove("active");
};

// Analysis Execution Logic
async function analyze() {
  const btn = document.querySelector(".primary");
  const input = document.getElementById("productInput").value.trim();
  if(!input) return alert("Enter a product URL or name.");

  // UI Loading State
  btn.innerText = "Analyzing...";
  btn.disabled = true;
  const dashboard = document.getElementById("dashboard");
  const contentArea = document.getElementById("dashboard-content");
  
  dashboard.style.display = "block";
  contentArea.innerHTML = `
    <div style="text-align: center; color: var(--muted); padding: 40px;">
      <div style="font-size: 24px; margin-bottom: 15px;">‚öôÔ∏è</div>
      Protocol Active: Ingesting Data & Reasoning...<br>
      <span style="font-size: 12px; opacity: 0.7;">(This takes 10-20 seconds for deep web scans)</span>
    </div>
  `;

  try {
    // REAL BACKEND FETCH
    const response = await fetch(`/trigger-claw?url=${encodeURIComponent(input)}&mode=${mode}`, { method: 'POST' });
    const data = await response.json();
    
    if (data.error) throw new Error(data.error);

    // Render Markdown beautifully
    contentArea.innerHTML = marked.parse(data.result);

  } catch (error) {
    contentArea.innerHTML = `
      <div style="color: var(--danger); text-align: center; padding: 20px;">
        <strong>Error Executing Scan:</strong><br>
        ${error.message}
      </div>
    `;
  } finally {
    btn.innerText = "Analyze";
    btn.disabled = false;
  }
}
</script>

</body>
</html>